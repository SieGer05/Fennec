[
    {
        "directive": "ssl",
        "expected": "1",
        "severity": "critical",
        "description": "Active le chiffrement SSL/TLS pour toutes les connexions à l'interface Webmin, empêchant l'interception des identifiants et des données sensibles sur le réseau. Sans SSL, les mots de passe sont transmis en clair.",
        "file": "/etc/webmin/miniserv.conf",
        "source": "https://dox.webmin.com/Webmin/SSL_Encryption.html"
    },
    {
        "directive": "keyfile",
        "expected": "/etc/webmin/mini-server.pem",
        "severity": "high",
        "description": "Spécifie le chemin vers un certificat SSL privé valide. Utiliser un certificat auto-signé par défaut est risqué ; un certificat signé par une autorité reconnue (ex: Let's Encrypt) renforce la confiance et la sécurité.",
        "file": "/etc/webmin/miniserv.conf",
        "source": "https://dox.webmin.com/Webmin/SSL_Encryption.html"
    },
    {
        "directive": "certfile",
        "expected": "/etc/webmin/mini-server.pem",
        "severity": "high",
        "description": "Assure que le certificat utilisé est valide et à jour. Un certificat expiré ou auto-signé peut être exploité dans des attaques de type man-in-the-middle.",
        "file": "/etc/webmin/miniserv.conf",
        "source": "https://dox.webmin.com/Webmin/SSL_Encryption.html"
    },
    {
        "directive": "ssl_version",
        "expected": "TLSv1.2,TLSv1.3",
        "severity": "high",
        "description": "Restreint les versions de protocole SSL/TLS aux seules versions sécurisées (TLS 1.2 et 1.3), désactivant les protocoles obsolètes comme SSLv3, TLS 1.0 et 1.1, vulnérables à des attaques connues.",
        "file": "/etc/webmin/miniserv.conf",
        "source": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r2.pdf"
    },
    {
        "directive": "log",
        "expected": "/var/webmin/miniserv.log",
        "severity": "high",
        "description": "Active la journalisation détaillée de toutes les connexions et actions administratives dans un fichier dédié, essentiel pour la surveillance, l'audit et la réponse aux incidents.",
        "file": "/etc/webmin/miniserv.conf",
        "source": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-92r1.pdf"
    },
    {
        "directive": "syslog",
        "expected": "1",
        "severity": "medium",
        "description": "Envoie les journaux de Webmin vers le système syslog, facilitant la centralisation, la rotation et la surveillance des logs par des outils externes.",
        "file": "/etc/webmin/miniserv.conf",
        "source": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-92r1.pdf"
    },
    {
        "directive": "root",
        "expected": "disabled",
        "severity": "critical",
        "description": "Désactive la connexion directe avec le compte root via Webmin, forçant l'utilisation de comptes d'administrateurs dédiés et appliquant le principe du moindre privilège.",
        "file": "/etc/webmin/webmin.acl",
        "source": "https://dox.webmin.com/Webmin/Webmin_Users.html"
    },
    {
        "directive": "theme",
        "expected": "authentic-theme",
        "severity": "medium",
        "description": "Utilise un thème actif et régulièrement mis à jour comme Authentic Theme, qui corrige rapidement les vulnérabilités de sécurité par rapport aux thèmes obsolètes.",
        "file": "/etc/webmin/config",
        "source": "https://github.com/authentic-theme/authentic-theme"
    }
]