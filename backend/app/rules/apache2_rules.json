[
  {
      "directive": "ServerTokens",
      "expected": "Prod",
      "severity": "high",
      "description": "Minimize server information in HTTP response headers. This configuration hides detailed Apache version and installed modules, reducing information available to attackers during reconnaissance.",
      "file": "/etc/apache2/conf-available/security.conf",
      "source": "AS24-U2-000470 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "ServerSignature",
      "expected": "Off",
      "severity": "high",
      "description": "Remove server signature lines from server-generated documents. This eliminates server information display in error pages and directory listings, reducing exposure of sensitive details.",
      "file": "/etc/apache2/conf-available/security.conf",
      "source": "AS24-U2-000470 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "TraceEnable",
      "expected": "off",
      "severity": "high",
      "description": "Disable HTTP TRACE method to prevent diagnostic abuse. This method can be exploited in cross-site scripting (XSS) attacks and to bypass certain browser security protections.",
      "file": "/etc/apache2/conf-available/security.conf",
      "source": "AS24-U2-000590 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "Options",
      "expected": "-Indexes -FollowSymLinks",
      "severity": "high",
      "description": "Disable directory browsing and symbolic link following. This prevents unauthorized directory listing and potential access to files outside the web root through symbolic links.",
      "file": "/etc/apache2/apache2.conf",
      "source": "AS24-U2-000300 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "AllowOverride",
      "expected": "None",
      "severity": "high",
      "description": "Disable overrides for the root directory to prevent unauthorized configuration changes. This prevents use of .htaccess files that could compromise overall server security.",
      "file": "/etc/apache2/apache2.conf",
      "source": "AS24-U2-000320 https://public.cyber.mil/stigs/downloads/"
  },
  {
    "directive": "FilesMatch",
    "expected": "\"^\\.(htaccess|htpasswd|svn|git)\"",
    "severity": "high",
    "description": "Restrict access to sensitive configuration and version control files. This protects .htaccess, .htpasswd, and repository files from direct web access.",
    "file": "/etc/apache2/apache2.conf",
    "source": "AS24-U2-000310 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "SSLProtocol",
      "expected": "all -SSLv3 +TLSv1.2 +TLSv1.3",
      "severity": "high",
      "description": "Disable insecure TLS protocols to improve security. This configuration enforces TLS 1.2+ only, eliminating known vulnerabilities in older encryption protocol versions.",
      "file": "/etc/apache2/mods-available/ssl.conf",
      "source": "AS24-U2-000030 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "SSLCipherSuite",
      "expected": "HIGH:!aNULL:!MD5:!3DES:!RC4",
      "severity": "high",
      "description": "Use only modern, secure cipher suites with Perfect Forward Secrecy. This configuration ensures strong encryption and protects past communications even if private keys are compromised.",
      "file": "/etc/apache2/mods-available/ssl.conf",
      "source": "AS24-U2-000030 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "SSLHonorCipherOrder",
      "expected": "on",
      "severity": "high",
      "description": "Enforce server cipher suite preference order. This ensures the server's preferred cipher suites are used rather than client preferences, maintaining security standards.",
      "file": "/etc/apache2/mods-available/ssl.conf",
      "source": "AS24-U2-000030 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "SSLInsecureRenegotiation",
      "expected": "off",
      "severity": "high",
      "description": "Disable insecure SSL renegotiation to prevent man-in-the-middle attacks. This protects against TLS renegotiation vulnerabilities that can expose communications to interception.",
      "file": "/etc/apache2/mods-available/ssl.conf",
      "source": "AS24-U2-000030 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "Header",
      "expected": "always set Strict-Transport-Security \"max-age=31536000; includeSubDomains\"",
      "severity": "medium",
      "description": "Enable HSTS to enforce HTTPS communications. This header forces browsers to use HTTPS exclusively for one year, including all subdomains, preventing protocol downgrade attacks.",
      "file": "/etc/apache2/conf-available/security.conf",
      "source": "AS24-U2-000030 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "Header",
      "expected": "always set X-Content-Type-Options nosniff",
      "severity": "medium",
      "description": "Prevent MIME type sniffing attacks by enforcing declared content types. This header stops browsers from interpreting files as different MIME types than declared, preventing XSS attacks.",
      "file": "/etc/apache2/conf-available/security.conf",
      "source": "OWASP Secure Headers Project"
  },
  {
      "directive": "Header",
      "expected": "always set Strict-Transport-Security \"max-age=31536000; includeSubDomains\"",
      "severity": "medium",
      "description": "Enable HSTS to enforce HTTPS communications. Forces browsers to use HTTPS exclusively for one year, including all subdomains, preventing protocol downgrade attacks.",
      "file": "/etc/apache2/conf-available/security.conf",
      "source": "AS24-U2-000030 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "Header",
      "expected": "always set X-Frame-Options DENY",
      "severity": "medium",
      "description": "Prevent clickjacking attacks by disabling iframe embedding. This header prevents the site from being embedded in frames, protecting against UI redressing attacks.",
      "file": "/etc/apache2/conf-available/security.conf",
      "source": "OWASP Secure Headers Project"
  },
  {
      "directive": "LimitRequestLine",
      "expected": "8190",
      "severity": "medium",
      "description": "Limit HTTP request line size to prevent buffer overflow attacks. This restriction protects against denial of service and exploitation attempts using excessively long requests.",
      "file": "/etc/apache2/apache2.conf",
      "source": "AS24-U2-000590 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "LimitRequestFields",
      "expected": "100",
      "severity": "medium",
      "description": "Limit the number of HTTP request fields to prevent resource exhaustion. This protects against attacks attempting to overload the server with excessive HTTP headers.",
      "file": "/etc/apache2/apache2.conf",
      "source": "AS24-U2-000590 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "LimitRequestFieldSize",
      "expected": "8190",
      "severity": "medium",
      "description": "Limit HTTP request field size to prevent header injection attacks. This controls the maximum size of individual headers, protecting against malformed or oversized header exploitation.",
      "file": "/etc/apache2/apache2.conf",
      "source": "AS24-U2-000590 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "Timeout",
      "expected": "60",
      "severity": "low",
      "description": "Set request timeout to prevent slow HTTP attacks. This limits how long the server waits for requests, protecting against slowloris and similar denial of service attacks.",
      "file": "/etc/apache2/apache2.conf",
      "source": "AS24-U2-000590 https://public.cyber.mil/stigs/downloads/"
  },
  {
      "directive": "LogLevel",
      "expected": "warn",
      "severity": "low",
      "description": "Set appropriate logging level for security monitoring. This captures important security events without excessive verbosity, facilitating security incident detection and analysis.",
      "file": "/etc/apache2/apache2.conf",
      "source": "AS24-U2-000090 https://public.cyber.mil/stigs/downloads/"
  }
]